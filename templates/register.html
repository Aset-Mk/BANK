{% extends 'base.html' %}

{% block content %}
<style>
    .auth-card {
        border: none;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    }
    
    .register-header {
        background: linear-gradient(135deg, #ff5722 0%, #ff8a65 100%);
        color: white;
        padding: 30px;
        text-align: center;
        border-radius: 20px 20px 0 0;
    }

    .input-group-text {
        background-color: #f8f9fa;
        border-right: none;
    }
    .form-control {
        border-left: none;
    }
    .form-control:focus {
        border-color: #ced4da;
        box-shadow: none;
        border-bottom: 2px solid #ff5722;
    }
    .input-group:focus-within {
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        border-radius: 0.375rem;
    }
    
    .btn-register {
        background-color: #1e1e2f;
        color: white;
        padding: 12px;
        border-radius: 10px;
        font-weight: 600;
        border: none;
        transition: 0.3s;
    }
    .btn-register:hover {
        background-color: #2c3e50;
        transform: translateY(-2px);
    }

    /* Стили для валидации пароля */
    .password-requirements {
        font-size: 0.75rem;
        margin-top: 5px;
        padding-left: 0;
        list-style: none;
    }
    .password-requirements li {
        margin-bottom: 2px;
        color: #A3AED0;
        transition: 0.3s;
    }
    .password-requirements li i {
        width: 15px;
        margin-right: 5px;
    }
    .req-valid {
        color: #05CD99 !important; /* Зеленый цвет успеха */
        font-weight: 600;
    }
</style>

<div class="row justify-content-center my-4">
    <div class="col-md-6 col-lg-5">
        <div class="card auth-card">
            <div class="register-header">
                <h3 class="fw-bold mb-1">Создать аккаунт</h3>
                <p class="m-0 small opacity-75">Станьте клиентом банка за 1 минуту</p>
            </div>
            
            <div class="card-body p-4 p-md-5">
                <form method="POST">
                    <!-- Логин -->
                    <div class="mb-3">
                        <label class="form-label small text-muted fw-bold">Логин</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-user text-muted"></i></span>
                            <input type="text" name="username" class="form-control py-2" placeholder="Придумайте логин" required>
                        </div>
                    </div>

                    <!-- Пароль с валидацией -->
                    <div class="mb-3">
                        <label class="form-label small text-muted fw-bold">Пароль</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-lock text-muted"></i></span>
                            <!-- 
                                pattern объяснение:
                                (?=.*\d) - хотя бы одна цифра
                                (?=.*[a-z]) - хотя бы одна строчная буква
                                (?=.*[A-Z]) - хотя бы одна заглавная буква
                                .{8,} - минимум 8 символов
                            -->
                            <input type="password" 
                                   name="password" 
                                   id="passwordInput"
                                   class="form-control py-2" 
                                   placeholder="•••••••" 
                                   required 
                                   pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
                                   title="Пароль должен содержать минимум 8 символов, заглавную букву, строчную букву и цифру">
                        </div>
                        <!-- Список требований (визуальный) -->
                        <ul class="password-requirements mt-2">
                            <li id="req-len"><i class="far fa-circle"></i>Минимум 8 символов</li>
                            <li id="req-num"><i class="far fa-circle"></i>Хотя бы одна цифра</li>
                            <li id="req-low"><i class="far fa-circle"></i>Строчная буква (a-z)</li>
                            <li id="req-upp"><i class="far fa-circle"></i>Заглавная буква (A-Z)</li>
                        </ul>
                    </div>

                    <!-- ФИО -->
                    <div class="mb-3">
                        <label class="form-label small text-muted fw-bold">ФИО</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-id-card text-muted"></i></span>
                            <input type="text" name="name" class="form-control py-2" placeholder="Иванов Иван" required>
                        </div>
                    </div>

                    <!-- Email -->
                    <div class="mb-4">
                        <label class="form-label small text-muted fw-bold">Email</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-envelope text-muted"></i></span>
                            <input type="email" name="email" class="form-control py-2" placeholder="mail@example.com" required>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-register w-100 mb-3">
                        Зарегистрироваться
                    </button>
                    
                    <div class="text-center">
                        <span class="text-muted small">Уже есть счет?</span>
                        <a href="/login" class="text-decoration-none fw-bold ms-1" style="color: #ff5722;">Войти</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Скрипт для проверки сложности пароля в реальном времени -->
<script>
    const passwordInput = document.getElementById('passwordInput');
    const reqLen = document.getElementById('req-len');
    const reqNum = document.getElementById('req-num');
    const reqLow = document.getElementById('req-low');
    const reqUpp = document.getElementById('req-upp');

    passwordInput.addEventListener('keyup', function() {
        const val = passwordInput.value;

        // 1. Длина
        if (val.length >= 8) updateStatus(reqLen, true);
        else updateStatus(reqLen, false);

        // 2. Цифра
        if (/\d/.test(val)) updateStatus(reqNum, true);
        else updateStatus(reqNum, false);

        // 3. Строчная буква
        if (/[a-z]/.test(val)) updateStatus(reqLow, true);
        else updateStatus(reqLow, false);

        // 4. Заглавная буква
        if (/[A-Z]/.test(val)) updateStatus(reqUpp, true);
        else updateStatus(reqUpp, false);
    });

    function updateStatus(element, isValid) {
        const icon = element.querySelector('i');
        if (isValid) {
            element.classList.add('req-valid');
            icon.classList.remove('fa-circle', 'far');
            icon.classList.add('fa-check-circle', 'fas');
        } else {
            element.classList.remove('req-valid');
            icon.classList.add('fa-circle', 'far');
            icon.classList.remove('fa-check-circle', 'fas');
        }
    }
</script>
{% endblock %}
